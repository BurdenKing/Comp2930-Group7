<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ParkAway</title> 
    <meta charset="utf-8" />
    <meta name = "viewport" content="width=device-width, initial-scale=1" />
    <style>
    #map {
      height: 700px;  /* The height is 700 pixels */
      width: 40%;  /* The width is the width of the web page */
      margin: auto;

     }
    </style>
    <!-- Adding Bootstrap CSS Stylesheet -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"  
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> 
    <!-- Adding jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>               
<script>
//connects to firebase


const firebaseConfig = {
  apiKey: "AIzaSyC92FAonMbNaZiapSbs_A0RDzS0YPgpcMw",
  authDomain: "parkaway-comp2930.firebaseapp.com",
  databaseURL: "https://parkaway-comp2930.firebaseio.com",
  projectId: "parkaway-comp2930",
  storageBucket: "parkaway-comp2930.appspot.com",
  messagingSenderId: "817259487218",
  appId: "1:817259487218:web:c64c81d3cf0c5465"
};
  firebase.initializeApp(firebaseConfig);

// Initialize and add the map


var lotAColor;

        
        //Function to read data from firebase


        //Read parking lot status from Firebase.


        var database = firebase.database();
        
        //root ref to firebase.
        var ref = database.ref().child('parkinglot');
        ref.on('value',getData);
        
        
        function getData(data){

        //Rgb color to hex conversion.
            function rgbtoHex(rgb) { 
           var hex = Number(rgb).toString(16);
            if (hex.length < 2) {
                hex = "0" + hex;
            }
            return hex;
          };

          var lots = data.val();
          console.log(lots);
          var lotArray = Object.keys(lots);
          console.log(lotArray);
          console.log(lotArray[0]);

        function lotColor(lotName){
          for (var i = 0; i < lotArray.length; i++){
            var k = lotArray[i];
            if(lotName == lotArray[i]){
              var coloNum = lots[k].full;
            }
          }
          var myColor = "#" + rgbtoHex(255 - (255 * colorNum / 100)) + rgbtoHex(255 * (colorNum / 100)) + rgbtoHex(0);
          return myColor;
        }
      

      lotAColor = lotColor("lotA");
        }

function initMap() {
        var BCIT = {lat: 49.248, lng: -123.0018124};




        //customize icon.
        var parkingIcon =
            'https://developers.google.com/maps/documentation/javascript/examples/full/images/parking_lot_maps.png'

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15.5,
          zoomControl: false,
          center: BCIT,
          gestureHandling: 'cooperative'

        });

        

        var lotA = new google.maps.Marker({
          position: {lat: 49.2520931, lng:-122.9987794},
          map: map,
          title: 'Student Parking Lot A',
          icon: parkingIcon
        });

        var lotB = new google.maps.Marker({
            position: {lat:49.2509521, lng: -122.9985251},
            map:map,
            title: 'Student Parking Lot B'
        });

        var lotD = new google.maps.Marker({
            position: {lat:49.2480284, lng:-122.9991663},
            map:map,
            title: 'Student Parking Lot D'
        });

        
        var lotF = new google.maps.Marker({
            position: {lat: 49.2471789, lng:-122.9989153},
            map:map,
            title: 'Student Parking Lot F'
        });


        var lotG = new google.maps.Marker({
            position: {lat: 49.2460731, lng: -122.9980626},
            map:map,
            title: 'Student Parking Lot G'
        });


        var lotJ = new google.maps.Marker({
            position: {lat: 49.2453803,lng: -123.0021826},
            map:map,
            title: 'Student Parking Lot J'
        });

        var lotK = new google.maps.Marker({
            position: {lat: 49.2453292,lng: -123.0010095},
            map:map,
            title: 'Student Parking Lot K'
        });

        var lotL = new google.maps.Marker({
            position: {lat: 49.2449058,lng: -123.001035},
            map:map,
            title: 'Student Parking Lot L'
        });

        var lotN = new google.maps.Marker({
            position: {lat: 49.2447456, lng: -123.0024028},
            map:map,
            title: 'Student Parking Lot N'
        });

        var lotO = new google.maps.Marker({
            position: {lat: 49.2424306, lng: -123.0004639},
            map:map,
            title: 'Student Parking Lot O'
        });

        var lotQ = new google.maps.Marker({
            position: {lat:49.2541109,lng:-123.0036502},
            map:map,
            title: 'Student Parking Lot Q'
        });






        var lotACircle = new google.maps.Circle({
            strokeColor: (255, 20, 180),
            strokeOpacity: 0.8,
            strokeWeight: 1,
            fillColor: lotAColor,
            fillOpacity: 0.6,
            map: map,
            center: lotA.position,
            radius: 45
          });

        var lotBCircle = new google.maps.Circle({
            strokeColor: lotBColor,
            strokeOpacity: 0.8,
            strokeWeight: 1,
            fillColor: lotBColor,
            fillOpacity: 0.6,
            map: map,
            center: lotB.position,
            radius: 45
          });
        

        lotA.addListener('click',function(){
          alert('successful');
        });

        lotACircle.addListener('click',function(){
          alert('lotA');
        });
  }



   

    </script>
      <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDbYdIySAdQvNbv1rxf0rkD6n_SGUkm_dM&callback=initMap">
      </script>

  </head>
  <body>
    <!-- Adding a heading (with a navigation bar) -->  
    <header>
      <!-- Left side of the navigation bar -->
      <div class = "leftNav"><a href="#" class="logo">ParkAway</a></div>
      <!-- Adding a navigation bar 
        -- Center of the navigation bar 
        --> 
      <nav>
        <ul>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Services</a></li>
          <li><a href="#">Contact</a></li>  
        </ul>    
      </nav>
      <!-- Right side of the header -->
      <div class = "rightNav"><button class="btn btn-primary btn-lg myButton" type="submit">Sign In</button></div>
    </header>



    <!-- Map -->
    <div id="map"></div>


    <!-- Scroll down button -->

  </body>
</html>
